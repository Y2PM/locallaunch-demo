---
import Header from '../components/Header.astro';
import Footer from '../components/Footer.astro';

interface Props {
  title: string;
  description: string;
  path?: string;
}

const { title, description, path = '/' } = Astro.props;
const siteUrl = Astro.site ?? 'https://y2pm.github.io/locallaunch-demo/';
const baseUrl = import.meta.env.BASE_URL;

const withBase = (target: string) => {
  const normalizedBase = baseUrl.endsWith('/') ? baseUrl : `${baseUrl}/`;
  const normalized = target.startsWith('/') ? target.slice(1) : target;
  return `${normalizedBase}${normalized}`;
};

const canonicalUrl = new URL(withBase(path), siteUrl).toString();
const ogImageUrl = new URL(withBase('og-image.svg'), siteUrl).toString();
---
<!doctype html>
<html lang="en" data-theme="dark">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="description" content={description} />
    <meta property="og:type" content="website" />
    <meta property="og:site_name" content="LocalLaunch" />
    <meta property="og:title" content={title} />
    <meta property="og:description" content={description} />
    <meta property="og:url" content={canonicalUrl} />
    <meta property="og:image" content={ogImageUrl} />
    <meta property="og:image:width" content="1200" />
    <meta property="og:image:height" content="630" />
    <title>{title}</title>
    <link rel="icon" type="image/svg+xml" href={withBase('favicon.svg')} />
    <script is:inline>
      (() => {
        const saved = localStorage.getItem('theme');
        const preferred = saved || 'dark';
        document.documentElement.setAttribute('data-theme', preferred);
      })();
    </script>
  </head>
  <body>
    <Header />
    <main class="container">
      <slot />
    </main>
    <Footer />
  </body>
</html>

<style is:global>
  :root {
    --bg: #0b0e14;
    --bg-alt: #161b26;
    --text: #e9edf8;
    --muted: #b2bdd6;
    --brand: #74f0ff;
    --brand-strong: #2ecde4;
    --border: #273146;
    --card: #101624;
    --success: #7cf0aa;
  }

  :root[data-theme='light'] {
    --bg: #f6f8ff;
    --bg-alt: #ffffff;
    --text: #172033;
    --muted: #52607a;
    --brand: #007a96;
    --brand-strong: #005f74;
    --border: #d4deef;
    --card: #ffffff;
    --success: #1e8f52;
  }

  * { box-sizing: border-box; }
  body {
    margin: 0;
    font-family: Inter, system-ui, -apple-system, Segoe UI, Roboto, sans-serif;
    background: var(--bg);
    color: var(--text);
    line-height: 1.6;
  }

  a { color: var(--brand); }

  .container {
    width: min(1200px, 92vw);
    margin: 0 auto;
    padding: 1.4rem 0 4rem;
  }

  .section {
    background: var(--card);
    border: 1px solid var(--border);
    border-radius: 18px;
    padding: 1.25rem;
    margin: 1rem 0;
    box-shadow: 0 18px 40px -35px rgba(0, 0, 0, 0.85);
  }

  h1, h2, h3 { line-height: 1.2; margin-top: 0; }
  h1 { font-size: clamp(2rem, 6vw, 3.5rem); }
  h2 { font-size: clamp(1.4rem, 4vw, 2rem); }

  .btn {
    display: inline-block;
    text-decoration: none;
    background: var(--brand);
    color: #001017;
    font-weight: 700;
    padding: 0.7rem 1.05rem;
    border-radius: 999px;
    border: none;
    cursor: pointer;
    transition: transform 0.2s ease, box-shadow 0.2s ease, background 0.2s ease;
  }

  form .btn {
    background: color-mix(in oklab, var(--brand) 30%, #0a1626 70%);
    color: #f5fbff;
    border: 1px solid color-mix(in oklab, var(--brand) 45%, #142235 55%);
  }

  :root[data-theme='light'] form .btn {
    background: color-mix(in oklab, var(--brand) 14%, #ffffff 86%);
    color: #113043;
    border: 1px solid color-mix(in oklab, var(--brand) 32%, #d6e5ef 68%);
  }

  @media (hover: hover) and (pointer: fine) {
    .btn:hover {
      background: var(--brand-strong);
      color: #fff;
      transform: translateY(-1px);
      box-shadow: 0 12px 25px -14px color-mix(in oklab, var(--brand) 55%, black);
    }
  }

  .grid { display: grid; gap: 1rem; }

  @media (min-width: 768px) {
    .section { padding: 1.8rem; margin: 1.3rem 0; }
    .grid.cols-2 { grid-template-columns: repeat(2, minmax(0, 1fr)); }
    .grid.cols-3 { grid-template-columns: repeat(3, minmax(0, 1fr)); }
  }

  @media (min-width: 1024px) {
    body { line-height: 1.7; }
    .container { padding-top: 2rem; }
    .grid.cols-3 { gap: 1.2rem; }
  }

  input, textarea, select {
    width: 100%;
    padding: 0.65rem;
    border-radius: 8px;
    border: 1px solid var(--border);
    background: var(--bg-alt);
    color: var(--text);
    margin-top: 0.25rem;
  }

  label { font-weight: 600; display: block; margin: 0.7rem 0; }
  .muted { color: var(--muted); }
</style>
